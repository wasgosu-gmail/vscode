

# What is an Active GridLink Data Source
https://docs.oracle.com/middleware/1212/wls/JDBCA/gridlink_datasources.htm#JDBCA379

# Active GridLink Data Source
WebLogic 도메인에서 AGL(Active GridLink) 데이터 소스를 생성하려면 관리 콘솔 또는 WLST(WebLogic 스크립팅 도구)를 사용할 수 있습니다.

ActiveGridlink 속성 이해
- 신속한 장애 감지를 제공합니다.
- 연결 풀에서 잘못된 연결을 중단하고 제거합니다.
- XA, non-XA 모두 로드 밸런싱 지원
- RAC의 상태를 동적으로 감지하여 동작
- 예정된 DB 종료의 경우, 진행 중인 트랜잭션은 DB 연결이 종료되기 전에 처리되며, 이후 새로운 요청은 Active DB에 할당됨
- 예정되지 않은 DB 종료의 경우, 진행 중인 트랜잭션은 rollback 되고, 이후 새로운 요청은 Active DB에 할당됨

- 계획되거나 계획되지 않은 Oracle RAC 노드 중단에 대해 단계적 종료를 수행합니다. 
Oracle RAC 중단에 대한 단계적 처리를 참조하십시오 .
- 노드 추가 또는 제거와 같은 토폴로지 변경에 적응합니다.
- 클러스터에 재가입하는 인스턴스를 포함하여 모든 활성 Oracle RAC 인스턴스에 런타임 작업 요청을 배포합니다.

WebLogic Server 12.1.2에서 새 구성 속성 ActiveGridlink은 데이터 소스 구성을 AGL(Active GridLink) 데이터 소스로 명시적으로 선언하는 데 사용됩니다. GridLink 데이터 소스를 생성할 때 관리 콘솔에 의해 자동으로 활성화됩니다. 

WLST를 사용하여 데이터 소스 구성을 생성하는 경우 설정하는 것을 기억해야 합니다.
ActiveGridlink=true.




AGL(Active GridLink) 데이터 소스의 URL은 호스트 및 포트 쌍의 조합입니다. 
예를 들어:
jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST= 
    (ADDRESS=(PROTOCOL=TCP)(HOST=host1-vip)(PORT=1521)) 
    (ADDRESS=(프로토콜=TCP)(HOST=host2-vip)( 포트=1521))) 
    (CONNECT_DATA=(SERVICE_NAME=dbservice))


# 다중 데이터 소스를 활성 GridLink 데이터 소스로 마이그레이션하는 기본 단계
1. 관리 콘솔을 사용하여 구성에서 MDS 및 일반 데이터 소스를 삭제합니다.
2. 관리 콘솔을 사용하여 단일 AGL 데이터 소스를 추가하십시오.
- MDS와 동일한 JNDI 이름을 지정하십시오.
- 사용된 일반 데이터 소스에 따라 XA 또는 비XA 드라이버를 선택하십시오.
- 다중 데이터 소스 마이그레이션을 위한 구성 변경에 설명된 대로 전체 URL을 입력합니다 .
- 사용자 및 암호를 설정합니다. MDS 구성원에 있는 것과 동일해야 합니다.
- 온 테스트 GridLink 데이터 소스 연결 페이지를 클릭 테스트 모든 리스너를 새로운 URL을 확인합니다.
- ONS 연결에 대한 정보를 입력합니다. 하나 이상의 호스트 :포트 쌍을 지정하십시오 . 예를 들어, host1-vip:6200또는 scanaddress:6200. 가능하면 단일 SCAN 주소와 포트를 사용하십시오. FAN Enabled 가 선택되어 있는지 확인하십시오 .
- ONS 연결을 테스트합니다.
- 데이터 소스를 배포합니다.
- AGL 데이터 소스를 편집하고 추가 매개변수를 구성하십시오.


# JDBC GridLink 데이터 소스 생성 (오라클DB만 사용가능)
JDBC GridLink 데이터 소스 생성

JDBC GridLink 데이터 소스를 WebLogic 도메인에 추가하여 Oracle RAC 설치에 데이터베이스 접속을 구성합니다. 데이터 소스 및 해당 접속 풀은 시스템이 효율적으로 실행하도록 도와주는 접속 관리 프로세스를 제공합니다.

JDBC GridLink 데이터 소스를 생성하려면 다음과 같이 하십시오.

아직 수행하지 않은 경우 관리 콘솔의 변경 센터에서 잠금 및 편집을 누릅니다(변경 센터 사용 참조).
도메인 구조 트리에서 서비스를 확장한 다음 데이터 소스를 선택합니다.
데이터 소스 요약 페이지에서 새로 만들기를 누르고 GridLink 데이터 소스를 선택합니다.
JDBC 데이터 소스 속성 페이지에서 다음 정보를 입력하거나 선택합니다.
이름 - 이 JDBC GridLink 데이터 소스의 이름을 입력합니다. 이 이름은 구성 파일(config.xml)과 관리 콘솔에서 이 데이터 소스를 참조할 때 사용됩니다.

JNDI 이름 - 이 JDBC 데이터 소스가 바인딩되는 JNDI 경로를 입력합니다. 애플리케이션은 접속을 예약할 때 이 이름으로 JNDI 트리에서 데이터 소스를 조회합니다.

데이터베이스 드라이버 - 데이터베이스 접속을 생성하는 데 사용할 데이터베이스 드라이버를 선택합니다.

다음을 눌러 계속합니다.

트랜잭션 옵션 페이지에서 다음 단계를 수행합니다. JDBC GridLink 데이터 소스 속성 페이지에서 선택한 드라이버에 따라 이러한 옵션을 지정할 필요가 없을 수도 있습니다.
전역 트랜잭션 지원 - 이 데이터 소스에서 전역 트랜잭션 지원을 허용하려면 이 체크박스(기본값)를 선택합니다. 이 데이터 소스에서 전역 트랜잭션을 사용 안함으로 설정(무시)하려면 이 체크박스 선택을 취소합니다. 대부분의 경우 옵션을 선택한 상태로 두어야 합니다.

전역 트랜잭션 지원을 선택한 경우 다음과 같은 트랜잭션 처리 옵션을 선택합니다. 사용 가능한 옵션은 XA 드라이버 또는 비 XA 드라이버를 선택했는가에 따라 다릅니다.

2단계 커밋 - 표준 XA 처리를 사용하려면 이 옵션을 선택합니다.
이 옵션은 데이터베이스 접속을 만들기 위해 XA JDBC 드라이버를 선택하는 경우에만 사용할 수 있습니다.

마지막 리소스 로깅 - 마지막 리소스 로깅(LLR) 트랜잭션 최적화를 사용하여 전역 트랜잭션에 참여하기 위해 비XA JDBC 접속을 사용하려면 이 옵션을 선택합니다. 2단계 커밋 에뮬레이트 대신 이 옵션을 사용하는 것이 좋습니다.
이 옵션은 데이터베이스 접속을 만들기 위해 비 XA JDBC 드라이버를 선택하는 경우에만 사용할 수 있습니다.

2단계 커밋 에뮬레이트 - 비 XA JDBC 접속이 JTA를 사용하여 배치 트랜잭션에 대한 참여를 에뮬레이트할 수 있게 합니다. 애플리케이션에 추론 과정에 대한 내결함성이 있는 경우에만 이 옵션을 선택하십시오.
이 옵션은 데이터베이스 접속을 만들기 위해 비 XA JDBC 드라이버를 선택하는 경우에만 사용할 수 있습니다.

1단계 커밋 - 비 XA 접속을 전역 트랜잭션의 유일한 트랜잭션 참여자로 사용하려면 이 옵션을 선택합니다.
이 옵션은 데이터베이스 접속을 만들기 위해 비 XA JDBC 드라이버를 선택하는 경우에만 사용할 수 있습니다.

트랜잭션 옵션에 대한 자세한 내용은 GridLink 데이터 소스에 대한 트랜잭션 옵션 구성을 참조하십시오.

다음을 눌러 계속합니다.

GridLink 데이터 소스 접속 속성 옵션 페이지에서 전체 JDBC URL을 입력하거나 개별 호스트-포트 쌍 값을 입력할지 선택하고 관리자의 도움으로 JDBC URL을 생성할 수 있습니다.
접속 속성 페이지에서 다음 속성에 대한 값을 입력합니다.
전체 JDBC URL을 입력하도록 선택한 경우 전체 JDBC URL에 URL을 입력합니다. 그렇지 않으면 다음을 제공하십시오.

서비스 이름 - 접속할 데이터베이스의 서비스 이름을 지정합니다.
호스트 이름 및 포트 - 데이터베이스를 호스팅하는 서버의 DNS 이름/IP 주소 및 포트 번호를 입력합니다.
데이터베이스 사용자 이름 - 데이터 소스의 각 접속에 사용하려는 데이터베이스 사용자 계정 이름을 입력합니다.

비밀번호/비밀번호 확인 - 데이터베이스 사용자 계정 비밀번호를 입력합니다.

프로토콜 - 필요한 경우 값을 TCP에서 SDP로 변경합니다. 참고: SDP(Socket Direct Protocol)를 사용하려면 데이터베이스 네트워크가 Infiniband를 사용하도록 구성되어야 합니다.

oracle.jdbc.DRCPConnectionClass - 또는 환경에서 필요한 경우 DCRP(Database Resident Connection Pooling) 접속 클래스를 입력합니다.

다음을 눌러 계속합니다.

GridLink 데이터베이스 접속 테스트 페이지에서 접속 매개변수를 검토하고 모든 리스너 테스트를 누릅니다. 개별 리스너를 테스트하려면 리스너 테스트를 누릅니다.
WebLogic은 관리 서버에서 데이터베이스로의 접속을 생성하려고 시도합니다. 페이지 맨 위에 접속 테스트 결과가 표시됩니다. 테스트가 실패한 경우 구성 오류를 수정하고 테스트를 재시도해야 합니다.

다음을 눌러 계속합니다.

ONS 클라이언트 구성 페이지에서 다음 속성의 값을 입력합니다.
Oracle FAN 이벤트에 가입하려면 FAN 사용을 선택합니다.

각 ONS 노드에 대해 ONS 호스트 및 포트를 입력합니다. 데이터베이스에서 자동 ONS 기능이 지원되는 경우 ONS 호스트 및 포트 정보 입력은 선택사항입니다.

선택적으로 ONS에서 SSL 프로토콜을 사용하도록 하려면 ONS 전자 지갑 파일을 구성합니다.

다음을 눌러 계속합니다.

ONS 클라이언트 구성 테스트 페이지에서 매개변수를 검토하고 모든 ONS 노드 테스트를 누릅니다. 개별 노드를 테스트하려면 ONS 호스트 및 포트에 대해 ONS 노드 테스트를 누릅니다.
다음을 눌러 계속합니다.

대상 선택 페이지에서 데이터 소스를 배치할 서버 또는 클러스터를 선택합니다.
완료를 눌러 JDBC 데이터 소스 구성을 저장하고 선택된 대상에 데이터 소스를 배치합니다.
이 변경사항을 활성화하려면 관리 콘솔의 변경 센터에서 변경사항 활성화를 누릅니다.
모든 변경사항이 즉시 적용되는 것은 아니며 시스템을 재시작해야 하는 경우도 있습니다(변경 센터 사용 참조).








